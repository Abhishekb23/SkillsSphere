<div class="test-wrapper">
  <!-- Loader -->
  <div *ngIf="isLoading" class="loader">
    <div class="spinner-border text-teal" role="status"></div>
    <p>Loading test...</p>
  </div>

  <!-- Test Section -->
  <section class="test-container" *ngIf="!isLoading && testData">
    <!-- Header -->
    <mat-card class="test-header mat-elevation-z2">
      <div class="header-content">
        <!-- Thumbnail -->
        <div class="icon-container" *ngIf="thumbnailUrl">
          <img [src]="thumbnailUrl" alt="Test Thumbnail" />
        </div>
        <!-- Text -->
        <div class="text-content">
          <h2>{{ testData.title }}</h2>
          <p class="test-description">{{ testData.description }}</p>

          <!-- Admin Info -->
         <!-- Admin Info -->
<div *ngIf="isAdmin" class="test-meta">
  <p><strong>Created By:</strong> {{ testData.createdByName }}</p>
  <p><strong>Created At:</strong> {{ testData.createdAt | date:'medium' }}</p>
  <p>
    <strong>Status:</strong>
    <span class="badge" [ngClass]="testData.isActive ? 'active' : 'inactive'">
      {{ testData.isActive ? 'Active' : 'Inactive' }}
    </span>
  </p>
</div>

<!-- Action Buttons (Clean Aligned) -->
<div *ngIf="isAdmin" class="action-buttons">
  <button class="btn-edit" (click)="editTest()">
    <mat-icon>edit</mat-icon>
    Edit
  </button>

  <button class="btn-delete" (click)="deleteTest()">
    <mat-icon>delete</mat-icon>
    Delete
  </button>
</div>



        </div>
      </div>
    </mat-card>

    <!-- Questions -->
    <div *ngFor="let question of testData.questions; let i = index" class="question-wrapper">
      <mat-card class="question-card mat-elevation-z1">
        <h4>Q{{ i + 1 }}. {{ question.questionText }}</h4>

        <!-- Learner View -->
        <ng-container *ngIf="isLearner">
          <!-- Single Choice -->
          <mat-radio-group *ngIf="question.questionType === 'SingleChoice'"
            (change)="onSingleChoiceSelect(question.questionId, $event.value)">
            <mat-radio-button *ngFor="let option of question.options" [value]="option.optionId" class="option-item">
              {{ option.optionText }}
            </mat-radio-button>
          </mat-radio-group>

          <!-- Multiple Choice -->
          <div *ngIf="question.questionType === 'MultipleChoice'">
            <mat-checkbox *ngFor="let option of question.options" class="option-item"
              (change)="onMultipleChoiceChange(question.questionId, option.optionId, $event)">
              {{ option.optionText }}
            </mat-checkbox>
          </div>
        </ng-container>

        <!-- Admin View -->
        <ng-container *ngIf="isAdmin">
          <ul class="admin-options">
            <li *ngFor="let option of question.options" [ngClass]="option.isCorrect ? 'correct' : 'neutral'">
              {{ option.optionText }}
              <span *ngIf="option.isCorrect" class="tag">âœ” Correct</span>
            </li>
          </ul>
        </ng-container>
      </mat-card>
    </div>

    <!-- Submit -->
    <div class="submit-container" *ngIf="isLearner">
      <button class="btn-submit" (click)="submitTest()">Submit Test</button>
    </div>
  </section>
</div>